\ Problem 3
\ 
\ The prime factors of 13195 are 5, 7, 13 and 29.
\ 
\ What is the largest prime factor of the number 600851475143 ?

s" ../expectdepth.fs" included 

600851475143 constant input

: square ( n -- n * n)
	dup * ;

: sqrt ( n -- floor{sqrt{n}})	\ valid for n > 0 only
	>r 1 begin
		1+ dup square r@
	> until
	1- rdrop ;

: even ( a b -- f) \ a is evenly divided by b
	mod 0= ;

: divisor ( n -- n)
	dup sqrt 1+ 2 ?do
		dup i even if drop i leave then
	loop ;

: quotient ( n --)
	dup divisor / ;

: main ( n --)
	begin dup quotient tuck = until ;

input main 1 expectdepth .
false [if]
: /divisor ( n -- smallest-divisor quotient)
	dup divisor tuck / ;

: factors ( n -- list-of-factors)
	begin /divisor dup 1 = until drop ;

: test ( n --)
	factors begin depth while . repeat cr ;
[then]

