
local M = {}

function M.emit (command, filename, fn_name)
	if command == "push" or command == "pop" then
		return function (segment)
			local fixed = {pointer = true, constant = true, static = true, temp = true}
				if fixed[segment] then
					local push_template = [[
// push %s %s
@%s
D=%s
@SP
A=M
M=D
@SP
M=M+1]]
					local pop_template = [[
// pop %s %s
@SP
M=M-1
A=M
D=M
@%s
M=D
]]
