
local M = {}

function M.emit (command, filename, fn_name)
	if command == "push" or command == "pop" then
		return function (segment)
			local fixed = {pointer = true, constant = true, static = true, temp = true}
				if fixed[segment] then
					return function (arg)
						local push_template = string.format([[
// push *SEGMENT *ARG
@*CELL
D=*SOURCE
@SP
A=M
M=D
@SP
M=M+1]], 
					local pop_template = [[
// pop *SEGMENT *ARG
@SP
M=M-1
A=M
D=M
@*CELL
M=D]]
					
