local RANK = 1
local QUESTION = 2
local ANSWER = 3

local pretty = setmetatable({
	["\n"] = "\\n",
}, {__index = function (_, key) return key end})

local function query (msg, menu)
	menu = menu or {["y"] = true, ["n"] = true}

	if msg then
		io.write(msg)
	end

	io.write("[")

	for selection in pairs(menu) do
		io.write(string.format("%s ", pretty[selection]))
	end

	io.write("]")

	io.flush()
	repeat
		ans = io.read(1)
	until menu[ans]

	return string.byte(ans)
end

local function ask (card)
	print(card[QUESTION])
	query("Ready?", {["\n"] = true})
	print(card[ANSWER])

	if query("Did you get this one?") == "y" then
		card[RANK] = card[RANK] + 1
	else
		card[RANK] = 0
	end
end

local function examine (card)
	print(string.format("rank=%d", card[RANK]))
	print(string.format("question=%s", card[QUESTION]))
	print(string.format("answer=%s", card[ANSWER]))
	print()
end


dofile("cards/forth.lua")


for _, card in ipairs(data) do
	ask(card)
end


for _, card in ipairs(data) do
	examine(card)
end

ask(data[1])
examine(data[1])
