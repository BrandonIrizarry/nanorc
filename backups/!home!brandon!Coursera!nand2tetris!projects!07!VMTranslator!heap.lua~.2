local M = {}

local template = {
	["push"] = [[

// push %s %s
@%s
D=A
@%s
A=D+M
D=M
@SP
A=M
M=D
@SP
M=M+1
]],

	["pop"] = [[

// pop %s %s
@%s
D=A
@%s
D=D+M
@R13
M=D
@SP
M=M-1
A=M
D=M
@R13
A=M
M=D]]
}

local register = {
	["local"] = "LCL",
	["argument"] = "ARG",
	["this"] = "THIS",
	["that"] = "THAT"
}

M.push = function (name)
	return setmetatable({}, {__index = function (_, arg)
		return string.format(template["push"], name, arg, arg, register[name])
	end})
end

M.pop = function (name)
	return setmetatable({}, {__index = function (_, arg)
		return string.format(template["pop"], name, arg, arg, register[name])
	end})
end
